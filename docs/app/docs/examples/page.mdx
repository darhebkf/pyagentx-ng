import { Tabs } from 'nextra/components'

# Examples

Real-world examples to get you started.

## Basic Agent

A minimal agent that responds to SNMP queries:

```python filename="basic_agent.py"
from snmpkit import Agent, ObjectType, OctetString, Integer32

agent = Agent()

@agent.register("1.3.6.1.4.1.12345.1.1.0")
async def system_name():
    return ObjectType(OctetString("My Device"))

@agent.register("1.3.6.1.4.1.12345.1.2.0")
async def uptime_seconds():
    return ObjectType(Integer32(3600))

agent.run()
```

## Table Implementation

Expose tabular data via SNMP:

```python filename="table_agent.py"
from snmpkit import Agent, Table, ObjectType, OctetString, Integer32

agent = Agent()

# Define table data
interfaces = [
    {"index": 1, "name": "eth0", "status": 1},
    {"index": 2, "name": "eth1", "status": 2},
]

table = Table(
    base_oid="1.3.6.1.4.1.12345.2.1",
    columns={
        1: ("ifIndex", Integer32),
        2: ("ifName", OctetString),
        3: ("ifStatus", Integer32),
    },
)

@agent.register_table(table)
async def get_interfaces():
    return interfaces

agent.run()
```

## Async Data Sources

Fetch data from async sources:

<Tabs items={['Database', 'HTTP API', 'File']}>
  <Tabs.Tab>
```python
import asyncpg
from snmpkit import Agent, ObjectType, Integer32

agent = Agent()
pool = None

@agent.on_startup
async def setup():
    global pool
    pool = await asyncpg.create_pool("postgresql://localhost/mydb")

@agent.register("1.3.6.1.4.1.12345.3.1.0")
async def user_count():
    async with pool.acquire() as conn:
        count = await conn.fetchval("SELECT COUNT(*) FROM users")
    return ObjectType(Integer32(count))
```
  </Tabs.Tab>
  <Tabs.Tab>
```python
import httpx
from snmpkit import Agent, ObjectType, Integer32

agent = Agent()
client = httpx.AsyncClient()

@agent.register("1.3.6.1.4.1.12345.3.2.0")
async def api_health():
    resp = await client.get("https://api.example.com/health")
    return ObjectType(Integer32(1 if resp.status_code == 200 else 0))
```
  </Tabs.Tab>
  <Tabs.Tab>
```python
import aiofiles
from snmpkit import Agent, ObjectType, OctetString

agent = Agent()

@agent.register("1.3.6.1.4.1.12345.3.3.0")
async def config_version():
    async with aiofiles.open("/etc/myapp/version") as f:
        version = await f.read()
    return ObjectType(OctetString(version.strip()))
```
  </Tabs.Tab>
</Tabs>

## SET Operations

Handle SNMP SET requests:

```python filename="writable_agent.py"
from snmpkit import Agent, ObjectType, OctetString

agent = Agent()
device_name = "Default"

@agent.register("1.3.6.1.4.1.12345.4.1.0", writable=True)
async def device_name_handler(value=None):
    global device_name
    if value is not None:
        device_name = str(value)
    return ObjectType(OctetString(device_name))

agent.run()
```

## Multiple Contexts

Support SNMP contexts for multi-tenant scenarios:

```python filename="context_agent.py"
from snmpkit import Agent, ObjectType, OctetString

agent = Agent()

@agent.register("1.3.6.1.4.1.12345.5.1.0", context="tenant-a")
async def tenant_a_data():
    return ObjectType(OctetString("Data for Tenant A"))

@agent.register("1.3.6.1.4.1.12345.5.1.0", context="tenant-b")
async def tenant_b_data():
    return ObjectType(OctetString("Data for Tenant B"))

agent.run()
```
